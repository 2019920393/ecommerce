# UC9 & UC10 åŠ¨æ€å»ºæ¨¡æ–‡æ¡£
## äº‘åŸç”Ÿå¾®æœåŠ¡ç”µå•†å¹³å° - åŠ¨æ€æ¨¡å‹å»ºæ¨¡

**é¡¹ç›®åç§°**ï¼šäº‘åŸç”Ÿå¾®æœåŠ¡ç”µå•†å¹³å°  
**ç”¨ä¾‹ç¼–å·**ï¼šUC9ï¼ˆåˆ›å»ºè®¢å•ï¼‰ã€UC10ï¼ˆè®¢å•æ”¯ä»˜ï¼‰  
**UMLç‰ˆæœ¬**ï¼šUML 2.5  
**ç¼–å†™æ—¥æœŸ**ï¼š2025-11-04

---

## ä¸€ã€åŠ¨æ€å»ºæ¨¡æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯åŠ¨æ€å»ºæ¨¡ï¼Ÿ

**åŠ¨æ€æ¨¡å‹**æ˜¯ä¸æ—¶é—´å’Œå˜åŒ–æœ‰å…³çš„ç³»ç»Ÿæ€§è´¨ï¼Œæè¿°äº†è½¯ä»¶å¦‚ä½•å¯¹å¤–éƒ¨äº‹ä»¶æˆ–æ¿€åŠ±åšå‡ºå“åº”ã€‚

åŠ¨æ€å»ºæ¨¡ä¸»è¦åŒ…æ‹¬ï¼š
1. **é¡ºåºå›¾ï¼ˆSequence Diagramï¼‰**ï¼šæ˜¾ç¤ºå¯¹è±¡ä¹‹é—´çš„äº¤äº’åºåˆ—
2. **çŠ¶æ€å›¾ï¼ˆState Diagramï¼‰**ï¼šæ˜¾ç¤ºå¯¹è±¡çš„çŠ¶æ€åŠçŠ¶æ€è½¬æ¢

### 1.2 åŠ¨æ€å»ºæ¨¡çš„æ­¥éª¤

æ ¹æ®è½¯ä»¶å·¥ç¨‹æ–¹æ³•è®ºï¼ŒåŠ¨æ€å»ºæ¨¡éœ€è¦å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. âœ… **è¯„ä¼°æ‰€æœ‰çš„ç”¨ä¾‹**ï¼Œä»¥ä¿è¯å®Œå…¨ç†è§£ç³»ç»Ÿå†…çš„äº¤äº’é¡ºåº
2. âœ… **è¯†åˆ«é©±åŠ¨äº¤äº’é¡ºåºçš„äº‹ä»¶**ï¼Œå¹¶ç†è§£è¿™äº›äº‹ä»¶å¦‚ä½•ä¸ç‰¹å®šçš„å¯¹è±¡ç›¸äº’å…³è”
3. âœ… **ä¸ºæ¯ä¸ªç”¨ä¾‹ç”Ÿæˆåºåˆ—**
4. âœ… **åˆ›å»ºç³»ç»ŸçŠ¶æ€å›¾**
5. âœ… **è¯„å®¡è¡Œä¸ºæ¨¡å‹**ä»¥éªŒè¯å‡†ç¡®æ€§å’Œä¸€è‡´æ€§

### 1.3 UML 2.5 åŠ¨æ€å»ºæ¨¡å…ƒç´ 

| UMLå›¾ç±»å‹ | ç”¨é€” | å…³é”®å…ƒç´  |
|----------|------|---------|
| **é¡ºåºå›¾** Sequence Diagram | å±•ç¤ºå¯¹è±¡é—´çš„æ—¶åºäº¤äº’ | ç”Ÿå‘½çº¿ã€æ¶ˆæ¯ã€æ¿€æ´»æ¡†ã€è¿”å›æ¶ˆæ¯ |
| **çŠ¶æ€å›¾** State Diagram | å±•ç¤ºå¯¹è±¡çš„çŠ¶æ€å˜åŒ– | çŠ¶æ€ã€è½¬æ¢ã€äº‹ä»¶ã€åŠ¨ä½œ |

---

## äºŒã€é¡ºåºå›¾ï¼ˆSequence Diagramï¼‰

### 2.1 UC9ï¼šåˆ›å»ºè®¢å• - é¡ºåºå›¾

#### 2.1.1 å‚ä¸å¯¹è±¡

| å¯¹è±¡ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| :User | Actor | ç”¨æˆ·ï¼ˆä¸»è¦å‚ä¸è€…ï¼‰ |
| :OrderController | Boundary | è®¢å•æ§åˆ¶å™¨ï¼ˆæ¥å£å±‚ï¼‰ |
| :OrderService | Control | è®¢å•æœåŠ¡ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ |
| :ShoppingCart | Entity | è´­ç‰©è½¦ |
| :CartItem | Entity | è´­ç‰©è½¦é¡¹ |
| :ShippingAddress | Entity | æ”¶è´§åœ°å€ |
| :InventoryService | Control | åº“å­˜æœåŠ¡ |
| :Inventory | Entity | åº“å­˜ |
| :Order | Entity | è®¢å• |
| :OrderItem | Entity | è®¢å•æ˜ç»† |

#### 2.1.2 é¡ºåºå›¾

![UC9_CreateOrder_Sequence](out/UML/åˆ›å»ºè®¢å•çš„é¡ºåºå›¾_CreateOrder_Sequence/UC9_CreateOrder_Sequence.png)

> ğŸ’¡ **PlantUMLæºæ–‡ä»¶**: `ç±»å›¾UML/UC9_CreateOrder_Sequence.puml`

---

<details>
<summary>ğŸ“ PlantUMLæºä»£ç ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```plantuml
@startuml UC9_CreateOrder_Sequence

!theme plain
skinparam sequenceMessageAlign center
skinparam responseMessageBelowArrow true

title UC9: åˆ›å»ºè®¢å• - é¡ºåºå›¾ (UML 2.5)

actor User as "ç”¨æˆ·"
participant "<<Boundary>>\n:OrderController" as Controller
participant "<<Control>>\n:OrderService" as OrderService
participant "<<Entity>>\n:ShoppingCart" as Cart
participant "<<Entity>>\n:CartItem" as CartItem
participant "<<Entity>>\n:ShippingAddress" as Address
participant "<<Control>>\n:InventoryService" as InventoryService
participant "<<Entity>>\n:Inventory" as Inventory
participant "<<Entity>>\n:Order" as Order
participant "<<Entity>>\n:OrderItem" as OrderItem

== 1. è¿›å…¥è®¢å•ç¡®è®¤é¡µé¢ ==

User -> Controller: ç‚¹å‡»"å»ç»“ç®—"(cartItemIds)
activate Controller

Controller -> OrderService: prepareOrder(userId, cartItemIds)
activate OrderService

OrderService -> Cart: getItems(cartItemIds)
activate Cart
Cart -> CartItem: getCartItemDetails()
activate CartItem
CartItem --> Cart: cartItemList
deactivate CartItem
Cart --> OrderService: cartItemList
deactivate Cart

OrderService -> Address: getDefaultAddress(userId)
activate Address
Address --> OrderService: defaultAddress
deactivate Address

OrderService --> Controller: orderConfirmData
deactivate OrderService

Controller --> User: æ˜¾ç¤ºè®¢å•ç¡®è®¤é¡µé¢
deactivate Controller

== 2. ç”¨æˆ·ç¡®è®¤è®¢å•ä¿¡æ¯ ==

User -> Controller: æäº¤è®¢å•(userId, cartItemIds, addressId)
activate Controller

Controller -> OrderService: createOrder(userId, cartItemIds, addressId)
activate OrderService

== 3. æ ¡éªŒåº“å­˜ ==

OrderService -> InventoryService: batchCheckStock(productList)
activate InventoryService

loop éå†æ¯ä¸ªå•†å“
    InventoryService -> Inventory: checkStock(productId, quantity)
    activate Inventory
    Inventory --> InventoryService: stockAvailable
    deactivate Inventory
end

InventoryService --> OrderService: stockCheckResult
deactivate InventoryService

alt åº“å­˜ä¸è¶³
    OrderService --> Controller: æŠ›å‡ºå¼‚å¸¸(åº“å­˜ä¸è¶³)
    Controller --> User: æ˜¾ç¤ºé”™è¯¯æç¤º
else åº“å­˜å……è¶³
    
    == 4. åˆ›å»ºè®¢å• ==
    
    OrderService -> Order: new Order()
    activate Order
    Order --> OrderService: order
    
    OrderService -> Order: setOrderInfo(userId, addressInfo, totalAmount)
    
    OrderService -> Order: generateOrderNumber()
    Order --> OrderService: orderNumber
    
    OrderService -> Order: setStatus(PENDING_PAYMENT)
    
    OrderService -> Order: setExpireTime(30åˆ†é’Ÿ)
    
    == 5. åˆ›å»ºè®¢å•æ˜ç»† ==
    
    loop éå†è´­ç‰©è½¦é¡¹
        OrderService -> OrderItem: createFromCartItem(cartItem)
        activate OrderItem
        OrderItem --> OrderService: orderItem
        
        OrderService -> Order: addOrderItem(orderItem)
        deactivate OrderItem
    end
    
    == 6. è®¡ç®—è®¢å•é‡‘é¢ ==
    
    OrderService -> Order: calculateTotalAmount()
    Order --> OrderService: totalAmount
    
    == 7. é¢„æ‰£åº“å­˜ ==
    
    OrderService -> InventoryService: lockStock(orderNumber, productList)
    activate InventoryService
    
    loop éå†æ¯ä¸ªå•†å“
        InventoryService -> Inventory: lockStock(quantity, orderNumber)
        activate Inventory
        Inventory -> Inventory: ä½¿ç”¨ä¹è§‚é”æ›´æ–°
        Inventory --> InventoryService: lockSuccess
        deactivate Inventory
    end
    
    InventoryService --> OrderService: allLocked
    deactivate InventoryService
    
    alt åº“å­˜é”å®šå¤±è´¥
        OrderService -> Order: delete()
        OrderService --> Controller: æŠ›å‡ºå¼‚å¸¸(åº“å­˜é”å®šå¤±è´¥)
        Controller --> User: æ˜¾ç¤ºé”™è¯¯æç¤º
    else åº“å­˜é”å®šæˆåŠŸ
        
        == 8. ä¿å­˜è®¢å• ==
        
        OrderService -> Order: save()
        Order --> OrderService: savedOrder
        deactivate Order
        
        OrderService --> Controller: order
        deactivate OrderService
        
        Controller --> User: è·³è½¬æ”¯ä»˜é¡µé¢(orderNumber)
        deactivate Controller
    end
end

@enduml
```

</details>

#### 2.1.3 é¡ºåºå›¾è¯´æ˜

**ä¸»è¦äº¤äº’æµç¨‹**ï¼š

1. **è¿›å…¥è®¢å•ç¡®è®¤é¡µé¢**ï¼ˆæ­¥éª¤1ï¼‰
   - ç”¨æˆ·ç‚¹å‡»"å»ç»“ç®—"
   - ç³»ç»Ÿè·å–è´­ç‰©è½¦é¡¹å’Œé»˜è®¤åœ°å€
   - æ˜¾ç¤ºè®¢å•ç¡®è®¤é¡µé¢

2. **æäº¤è®¢å•**ï¼ˆæ­¥éª¤2ï¼‰
   - ç”¨æˆ·ç¡®è®¤è®¢å•ä¿¡æ¯å¹¶æäº¤

3. **æ ¡éªŒåº“å­˜**ï¼ˆæ­¥éª¤3ï¼‰
   - æ‰¹é‡æ£€æŸ¥æ‰€æœ‰å•†å“åº“å­˜
   - ä½¿ç”¨å¾ªç¯éå†æ¯ä¸ªå•†å“

4. **åˆ›å»ºè®¢å•**ï¼ˆæ­¥éª¤4ï¼‰
   - åˆ›å»ºè®¢å•å¯¹è±¡
   - ç”Ÿæˆè®¢å•å·
   - è®¾ç½®è®¢å•çŠ¶æ€å’Œè¶…æ—¶æ—¶é—´

5. **åˆ›å»ºè®¢å•æ˜ç»†**ï¼ˆæ­¥éª¤5ï¼‰
   - å¾ªç¯åˆ›å»ºè®¢å•æ˜ç»†
   - ä»è´­ç‰©è½¦é¡¹è½¬æ¢ä¸ºè®¢å•æ˜ç»†

6. **è®¡ç®—é‡‘é¢**ï¼ˆæ­¥éª¤6ï¼‰
   - è®¡ç®—è®¢å•æ€»é‡‘é¢

7. **é¢„æ‰£åº“å­˜**ï¼ˆæ­¥éª¤7ï¼‰
   - ä½¿ç”¨ä¹è§‚é”é”å®šåº“å­˜
   - å¾ªç¯é”å®šæ¯ä¸ªå•†å“çš„åº“å­˜

8. **ä¿å­˜è®¢å•**ï¼ˆæ­¥éª¤8ï¼‰
   - ä¿å­˜è®¢å•åˆ°æ•°æ®åº“
   - è·³è½¬åˆ°æ”¯ä»˜é¡µé¢

**å…³é”®è®¾è®¡ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `alt` ç‰‡æ®µå¤„ç†åº“å­˜ä¸è¶³å’Œé”å®šå¤±è´¥çš„å¼‚å¸¸æƒ…å†µ
- âœ… ä½¿ç”¨ `loop` ç‰‡æ®µå¤„ç†æ‰¹é‡æ“ä½œ
- âœ… æ¸…æ™°æ ‡æ³¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆactivate/deactivateï¼‰
- âœ… ä½¿ç”¨åŒæ­¥æ¶ˆæ¯ï¼ˆå®çº¿ç®­å¤´ï¼‰è¡¨ç¤ºæ–¹æ³•è°ƒç”¨
- âœ… ä½¿ç”¨è¿”å›æ¶ˆæ¯ï¼ˆè™šçº¿ç®­å¤´ï¼‰è¡¨ç¤ºè¿”å›å€¼

---

### 2.2 UC10ï¼šè®¢å•æ”¯ä»˜ - é¡ºåºå›¾

#### 2.2.1 å‚ä¸å¯¹è±¡

| å¯¹è±¡ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| :User | Actor | ç”¨æˆ·ï¼ˆä¸»è¦å‚ä¸è€…ï¼‰ |
| :PaymentController | Boundary | æ”¯ä»˜æ§åˆ¶å™¨ï¼ˆæ¥å£å±‚ï¼‰ |
| :PaymentService | Control | æ”¯ä»˜æœåŠ¡ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ |
| :Order | Entity | è®¢å• |
| :PaymentOrder | Entity | æ”¯ä»˜è®¢å• |
| :PaymentGateway | External | æ”¯ä»˜ç½‘å…³ï¼ˆæ¨¡æ‹Ÿï¼‰ |
| :PaymentCallbackHandler | Control | æ”¯ä»˜å›è°ƒå¤„ç†å™¨ |
| :OrderService | Control | è®¢å•æœåŠ¡ |
| :InventoryService | Control | åº“å­˜æœåŠ¡ |
| :Inventory | Entity | åº“å­˜ |
| :ShoppingCart | Entity | è´­ç‰©è½¦ |
| :PaymentRecord | Entity | æ”¯ä»˜è®°å½• |

#### 2.2.2 é¡ºåºå›¾

![UC10_OrderPayment_Sequence](out/UML/æ”¯ä»˜é¡ºåºå›¾_OrderPayment_Sequence/UC10_OrderPayment_Sequence.png)

> ğŸ’¡ **PlantUMLæºæ–‡ä»¶**: `ç±»å›¾UML/UC10_OrderPayment_Sequence.puml`

---

<details>
<summary>ğŸ“ PlantUMLæºä»£ç ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```plantuml
@startuml UC10_OrderPayment_Sequence

!theme plain
skinparam sequenceMessageAlign center
skinparam responseMessageBelowArrow true

title UC10: è®¢å•æ”¯ä»˜ - é¡ºåºå›¾ (UML 2.5)

actor User as "ç”¨æˆ·"
participant "<<Boundary>>\n:PaymentController" as Controller
participant "<<Control>>\n:PaymentService" as PaymentService
participant "<<Entity>>\n:Order" as Order
participant "<<Entity>>\n:PaymentOrder" as PaymentOrder
participant "<<External>>\n:PaymentGateway" as Gateway
participant "<<Control>>\n:PaymentCallbackHandler" as CallbackHandler
participant "<<Control>>\n:OrderService" as OrderService
participant "<<Control>>\n:InventoryService" as InventoryService
participant "<<Entity>>\n:Inventory" as Inventory
participant "<<Entity>>\n:ShoppingCart" as Cart
participant "<<Entity>>\n:PaymentRecord" as Record

== 1. è¿›å…¥æ”¯ä»˜é¡µé¢ ==

User -> Controller: ç‚¹å‡»"å»æ”¯ä»˜"(orderNumber)
activate Controller

Controller -> PaymentService: getOrderForPayment(orderNumber)
activate PaymentService

PaymentService -> Order: findByOrderNumber(orderNumber)
activate Order
Order --> PaymentService: order
deactivate Order

PaymentService -> Order: isPaid()
activate Order
Order --> PaymentService: false
deactivate Order

PaymentService -> Order: isExpired()
activate Order
Order --> PaymentService: false
deactivate Order

PaymentService --> Controller: paymentPageData
deactivate PaymentService

Controller --> User: æ˜¾ç¤ºæ”¯ä»˜é¡µé¢(è®¢å•é‡‘é¢ã€æ”¯ä»˜æ–¹å¼)
deactivate Controller

== 2. ç”¨æˆ·é€‰æ‹©æ”¯ä»˜æ–¹å¼å¹¶ç¡®è®¤ ==

User -> Controller: ç¡®è®¤æ”¯ä»˜(orderNumber, paymentMethod)
activate Controller

Controller -> PaymentService: createPaymentOrder(orderNumber, paymentMethod)
activate PaymentService

== 3. åˆ›å»ºæ”¯ä»˜è®¢å• ==

PaymentService -> PaymentOrder: new PaymentOrder()
activate PaymentOrder
PaymentOrder --> PaymentService: paymentOrder

PaymentService -> PaymentOrder: generatePaymentNumber()
PaymentOrder --> PaymentService: paymentNumber

PaymentService -> PaymentOrder: setOrderInfo(orderId, amount)

PaymentService -> PaymentOrder: setPaymentMethod(paymentMethod)

PaymentService -> PaymentOrder: setStatus(PENDING)

PaymentService -> PaymentOrder: save()
PaymentOrder --> PaymentService: savedPaymentOrder
deactivate PaymentOrder

== 4. è°ƒç”¨æ”¯ä»˜ç½‘å…³ï¼ˆæ¨¡æ‹Ÿæ”¯ä»˜ï¼‰ ==

PaymentService -> Gateway: processPayment(paymentNumber, amount, method)
activate Gateway

Gateway -> Gateway: æ¨¡æ‹Ÿæ”¯ä»˜å¤„ç†(2-3ç§’)\næˆåŠŸç‡90%

Gateway --> PaymentService: paymentResult(success/fail)
deactivate Gateway

== 5. å¤„ç†æ”¯ä»˜å›è°ƒ ==

PaymentService -> CallbackHandler: handleCallback(paymentNumber, status, details)
activate CallbackHandler

alt æ”¯ä»˜æˆåŠŸ
    
    == 5.1 æ”¯ä»˜æˆåŠŸæµç¨‹ ==
    
    CallbackHandler -> PaymentOrder: updateStatus(SUCCESS)
    activate PaymentOrder
    PaymentOrder --> CallbackHandler: updated
    deactivate PaymentOrder
    
    CallbackHandler -> OrderService: updateOrderStatus(orderNumber, PENDING_SHIPMENT)
    activate OrderService
    OrderService -> Order: setStatus(PENDING_SHIPMENT)
    activate Order
    OrderService -> Order: setPayTime(now)
    Order --> OrderService: updated
    deactivate Order
    OrderService --> CallbackHandler: success
    deactivate OrderService
    
    CallbackHandler -> InventoryService: deductStock(orderNumber)
    activate InventoryService
    
    loop éå†è®¢å•å•†å“
        InventoryService -> Inventory: deductLockedStock(orderNumber)
        activate Inventory
        Inventory -> Inventory: å®é™…æ‰£å‡åº“å­˜
        Inventory --> InventoryService: deducted
        deactivate Inventory
    end
    
    InventoryService --> CallbackHandler: allDeducted
    deactivate InventoryService
    
    CallbackHandler -> Cart: clearPaidItems(userId, orderNumber)
    activate Cart
    Cart --> CallbackHandler: cleared
    deactivate Cart
    
    CallbackHandler -> Record: createPaymentRecord(paymentOrder, SUCCESS)
    activate Record
    Record --> CallbackHandler: record
    deactivate Record
    
    CallbackHandler --> PaymentService: success
    deactivate CallbackHandler
    
    PaymentService --> Controller: paymentSuccess
    deactivate PaymentService
    
    Controller --> User: æ˜¾ç¤ºæ”¯ä»˜æˆåŠŸé¡µé¢(æµæ°´å·)
    deactivate Controller

else æ”¯ä»˜å¤±è´¥
    
    == 5.2 æ”¯ä»˜å¤±è´¥æµç¨‹ ==
    
    CallbackHandler -> PaymentOrder: updateStatus(FAILED)
    activate PaymentOrder
    PaymentOrder --> CallbackHandler: updated
    deactivate PaymentOrder
    
    CallbackHandler -> OrderService: cancelOrder(orderNumber)
    activate OrderService
    OrderService -> Order: setStatus(CANCELLED)
    activate Order
    Order --> OrderService: cancelled
    deactivate Order
    OrderService --> CallbackHandler: cancelled
    deactivate OrderService
    
    CallbackHandler -> InventoryService: releaseStock(orderNumber)
    activate InventoryService
    
    loop éå†è®¢å•å•†å“
        InventoryService -> Inventory: releaseLockedStock(orderNumber)
        activate Inventory
        Inventory -> Inventory: é‡Šæ”¾é¢„æ‰£åº“å­˜
        Inventory --> InventoryService: released
        deactivate Inventory
    end
    
    InventoryService --> CallbackHandler: allReleased
    deactivate InventoryService
    
    CallbackHandler -> Record: createPaymentRecord(paymentOrder, FAILED)
    activate Record
    Record --> CallbackHandler: record
    deactivate Record
    
    CallbackHandler --> PaymentService: failed
    deactivate CallbackHandler
    
    PaymentService --> Controller: paymentFailed(reason)
    deactivate PaymentService
    
    Controller --> User: æ˜¾ç¤ºæ”¯ä»˜å¤±è´¥é¡µé¢(åŸå› )
    deactivate Controller
    
end

@enduml
```

</details>

#### 2.2.3 é¡ºåºå›¾è¯´æ˜

**ä¸»è¦äº¤äº’æµç¨‹**ï¼š

1. **è¿›å…¥æ”¯ä»˜é¡µé¢**ï¼ˆæ­¥éª¤1ï¼‰
   - ç”¨æˆ·ç‚¹å‡»"å»æ”¯ä»˜"
   - ç³»ç»ŸæŸ¥è¯¢è®¢å•ä¿¡æ¯
   - éªŒè¯è®¢å•çŠ¶æ€ï¼ˆæ˜¯å¦å·²æ”¯ä»˜ã€æ˜¯å¦è¶…æ—¶ï¼‰
   - æ˜¾ç¤ºæ”¯ä»˜é¡µé¢

2. **åˆ›å»ºæ”¯ä»˜è®¢å•**ï¼ˆæ­¥éª¤3ï¼‰
   - åˆ›å»ºæ”¯ä»˜è®¢å•å¯¹è±¡
   - ç”Ÿæˆæ”¯ä»˜æµæ°´å·
   - è®¾ç½®æ”¯ä»˜æ–¹å¼å’ŒçŠ¶æ€

3. **è°ƒç”¨æ”¯ä»˜ç½‘å…³**ï¼ˆæ­¥éª¤4ï¼‰
   - æ¨¡æ‹Ÿæ”¯ä»˜å¤„ç†ï¼ˆ2-3ç§’ï¼‰
   - 90%æˆåŠŸç‡

4. **å¤„ç†æ”¯ä»˜å›è°ƒ**ï¼ˆæ­¥éª¤5ï¼‰
   - ä½¿ç”¨ `alt` ç‰‡æ®µåŒºåˆ†æˆåŠŸå’Œå¤±è´¥æµç¨‹

5. **æ”¯ä»˜æˆåŠŸæµç¨‹**ï¼ˆæ­¥éª¤5.1ï¼‰
   - æ›´æ–°æ”¯ä»˜è®¢å•çŠ¶æ€
   - æ›´æ–°è®¢å•çŠ¶æ€ä¸º"å¾…å‘è´§"
   - å®é™…æ‰£å‡åº“å­˜
   - æ¸…ç©ºè´­ç‰©è½¦
   - ç”Ÿæˆæ”¯ä»˜è®°å½•
   - æ˜¾ç¤ºæ”¯ä»˜æˆåŠŸé¡µé¢

6. **æ”¯ä»˜å¤±è´¥æµç¨‹**ï¼ˆæ­¥éª¤5.2ï¼‰
   - æ›´æ–°æ”¯ä»˜è®¢å•çŠ¶æ€ä¸ºå¤±è´¥
   - å–æ¶ˆè®¢å•
   - é‡Šæ”¾é¢„æ‰£åº“å­˜
   - ç”Ÿæˆæ”¯ä»˜è®°å½•
   - æ˜¾ç¤ºæ”¯ä»˜å¤±è´¥é¡µé¢

**å…³é”®è®¾è®¡ç‚¹**ï¼š
- âœ… ä½¿ç”¨ `alt` ç‰‡æ®µæ¸…æ™°åŒºåˆ†æˆåŠŸå’Œå¤±è´¥ä¸¤ç§åœºæ™¯
- âœ… å±•ç¤ºäº†åˆ†å¸ƒå¼äº‹åŠ¡çš„å¤„ç†æµç¨‹
- âœ… ä½“ç°äº†æ”¯ä»˜å›è°ƒå¤„ç†å™¨çš„åè°ƒä½œç”¨
- âœ… ä½¿ç”¨ `loop` å¤„ç†æ‰¹é‡åº“å­˜æ“ä½œ
- âœ… æ ‡æ³¨äº†å¤–éƒ¨ç³»ç»Ÿï¼ˆPaymentGatewayï¼‰

---

## ä¸‰ã€çŠ¶æ€å›¾ï¼ˆState Diagramï¼‰

### 3.1 Orderï¼ˆè®¢å•ï¼‰- çŠ¶æ€å›¾

#### 3.1.1 çŠ¶æ€åˆ—è¡¨

| çŠ¶æ€ | è‹±æ–‡å | çŠ¶æ€ç  | è¯´æ˜ |
|------|--------|--------|------|
| å¾…æ”¯ä»˜ | PENDING_PAYMENT | 1 | è®¢å•å·²åˆ›å»ºï¼Œç­‰å¾…æ”¯ä»˜ |
| å¾…å‘è´§ | PENDING_SHIPMENT | 2 | å·²æ”¯ä»˜ï¼Œç­‰å¾…å‘è´§ |
| å¾…æ”¶è´§ | PENDING_RECEIPT | 3 | å·²å‘è´§ï¼Œç­‰å¾…æ”¶è´§ |
| å·²å®Œæˆ | COMPLETED | 4 | å·²æ”¶è´§ï¼Œäº¤æ˜“å®Œæˆ |
| å·²å–æ¶ˆ | CANCELLED | 5 | è®¢å•å·²å–æ¶ˆ |

#### 3.1.2 çŠ¶æ€å›¾

![Order_StateDiagram](out/UML/è®¢å•çŠ¶æ€å›¾_Order_StateDiagram/Order_StateDiagram.png)

> ğŸ’¡ **PlantUMLæºæ–‡ä»¶**: `ç±»å›¾UML/Order_StateDiagram.puml`

---

<details>
<summary>ğŸ“ PlantUMLæºä»£ç ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```plantuml
@startuml Order_StateDiagram

!theme plain

title Orderï¼ˆè®¢å•ï¼‰çŠ¶æ€å›¾ (UML 2.5)

[*] --> PENDING_PAYMENT : åˆ›å»ºè®¢å•\n[åº“å­˜å……è¶³]\n/ç”Ÿæˆè®¢å•å·\n/é¢„æ‰£åº“å­˜\n/è®¾ç½®è¶…æ—¶æ—¶é—´

state "å¾…æ”¯ä»˜\nPENDING_PAYMENT" as PENDING_PAYMENT {
    state "ç­‰å¾…ç”¨æˆ·æ”¯ä»˜" as Waiting
    state "æ£€æŸ¥è¶…æ—¶" as Checking
    
    Waiting --> Checking : å®šæ—¶æ£€æŸ¥
    Checking --> Waiting : [æœªè¶…æ—¶]
}

PENDING_PAYMENT --> PENDING_SHIPMENT : æ”¯ä»˜æˆåŠŸ\n/æ›´æ–°æ”¯ä»˜æ—¶é—´\n/æ‰£å‡åº“å­˜\n/æ¸…ç©ºè´­ç‰©è½¦

PENDING_PAYMENT --> CANCELLED : æ”¯ä»˜è¶…æ—¶(30åˆ†é’Ÿ)\n/é‡Šæ”¾åº“å­˜
PENDING_PAYMENT --> CANCELLED : ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆ\n/é‡Šæ”¾åº“å­˜
PENDING_PAYMENT --> CANCELLED : æ”¯ä»˜å¤±è´¥\n/é‡Šæ”¾åº“å­˜

state "å¾…å‘è´§\nPENDING_SHIPMENT" as PENDING_SHIPMENT {
    state "ç­‰å¾…å•†å®¶å‘è´§" as WaitingShip
}

PENDING_SHIPMENT --> PENDING_RECEIPT : å•†å®¶å‘è´§\n/æ›´æ–°ç‰©æµä¿¡æ¯\n/å‘é€é€šçŸ¥

PENDING_SHIPMENT --> CANCELLED : å•†å®¶å–æ¶ˆè®¢å•\n[ç‰¹æ®Šæƒ…å†µ]\n/é€€æ¬¾\n/æ¢å¤åº“å­˜

state "å¾…æ”¶è´§\nPENDING_RECEIPT" as PENDING_RECEIPT {
    state "é…é€ä¸­" as Shipping
    state "ç­‰å¾…ç¡®è®¤æ”¶è´§" as WaitingConfirm
    
    Shipping --> WaitingConfirm : é€è¾¾
}

PENDING_RECEIPT --> COMPLETED : ç”¨æˆ·ç¡®è®¤æ”¶è´§\n/è®°å½•æ”¶è´§æ—¶é—´\n/ç»“æŸäº¤æ˜“

PENDING_RECEIPT --> COMPLETED : è‡ªåŠ¨ç¡®è®¤æ”¶è´§(7å¤©)\n/è®°å½•æ”¶è´§æ—¶é—´

state "å·²å®Œæˆ\nCOMPLETED" as COMPLETED {
    state "äº¤æ˜“æˆåŠŸ" as Success
    state "å¯è¯„ä»·" as CanReview
    
    Success --> CanReview : è®¢å•å®Œæˆ
}

COMPLETED --> [*] : è®¢å•å½’æ¡£(30å¤©å)

state "å·²å–æ¶ˆ\nCANCELLED" as CANCELLED {
    state "å·²å–æ¶ˆ" as Canceled
}

CANCELLED --> [*] : è®¢å•å½’æ¡£(30å¤©å)

note right of PENDING_PAYMENT
  **è¿›å…¥æ¡ä»¶**:
  - ç”¨æˆ·æäº¤è®¢å•
  - åº“å­˜æ ¡éªŒé€šè¿‡
  - åœ°å€ä¿¡æ¯å®Œæ•´
  
  **é€€å‡ºæ¡ä»¶**:
  - æ”¯ä»˜æˆåŠŸ
  - è¶…æ—¶(30åˆ†é’Ÿ)
  - ä¸»åŠ¨å–æ¶ˆ
  - æ”¯ä»˜å¤±è´¥
end note

note right of PENDING_SHIPMENT
  **è¿›å…¥æ¡ä»¶**:
  - æ”¯ä»˜æˆåŠŸ
  - åº“å­˜å·²æ‰£å‡
  
  **é€€å‡ºæ¡ä»¶**:
  - å•†å®¶å‘è´§
  - å•†å®¶å–æ¶ˆ(å¼‚å¸¸)
end note

note right of COMPLETED
  **ç»ˆæ­¢çŠ¶æ€**
  ä¸å¯é€†è½¬
  
  **åç»­æ“ä½œ**:
  - ç”¨æˆ·è¯„ä»·
  - å”®åæœåŠ¡
  - è®¢å•å½’æ¡£
end note

@enduml
```

</details>

#### 3.1.3 çŠ¶æ€è½¬æ¢è¡¨

| å½“å‰çŠ¶æ€ | äº‹ä»¶ | å®ˆå«æ¡ä»¶ | åŠ¨ä½œ | ç›®æ ‡çŠ¶æ€ |
|---------|------|---------|------|---------|
| [åˆå§‹] | åˆ›å»ºè®¢å• | [åº“å­˜å……è¶³] | ç”Ÿæˆè®¢å•å·ã€é¢„æ‰£åº“å­˜ã€è®¾ç½®è¶…æ—¶ | å¾…æ”¯ä»˜ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜æˆåŠŸ | - | æ›´æ–°æ”¯ä»˜æ—¶é—´ã€æ‰£å‡åº“å­˜ã€æ¸…ç©ºè´­ç‰©è½¦ | å¾…å‘è´§ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜è¶…æ—¶ | [è¶…è¿‡30åˆ†é’Ÿ] | é‡Šæ”¾åº“å­˜ | å·²å–æ¶ˆ |
| å¾…æ”¯ä»˜ | ç”¨æˆ·å–æ¶ˆ | - | é‡Šæ”¾åº“å­˜ | å·²å–æ¶ˆ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜å¤±è´¥ | - | é‡Šæ”¾åº“å­˜ | å·²å–æ¶ˆ |
| å¾…å‘è´§ | å•†å®¶å‘è´§ | - | æ›´æ–°ç‰©æµä¿¡æ¯ã€å‘é€é€šçŸ¥ | å¾…æ”¶è´§ |
| å¾…å‘è´§ | å•†å®¶å–æ¶ˆ | [ç‰¹æ®Šæƒ…å†µ] | é€€æ¬¾ã€æ¢å¤åº“å­˜ | å·²å–æ¶ˆ |
| å¾…æ”¶è´§ | ç¡®è®¤æ”¶è´§ | - | è®°å½•æ”¶è´§æ—¶é—´ã€ç»“æŸäº¤æ˜“ | å·²å®Œæˆ |
| å¾…æ”¶è´§ | è‡ªåŠ¨ç¡®è®¤ | [7å¤©å] | è®°å½•æ”¶è´§æ—¶é—´ | å·²å®Œæˆ |
| å·²å®Œæˆ | è®¢å•å½’æ¡£ | [30å¤©å] | å½’æ¡£æ•°æ® | [ç»ˆæ­¢] |
| å·²å–æ¶ˆ | è®¢å•å½’æ¡£ | [30å¤©å] | å½’æ¡£æ•°æ® | [ç»ˆæ­¢] |

---

### 3.2 PaymentOrderï¼ˆæ”¯ä»˜è®¢å•ï¼‰- çŠ¶æ€å›¾

#### 3.2.1 çŠ¶æ€åˆ—è¡¨

| çŠ¶æ€ | è‹±æ–‡å | çŠ¶æ€ç  | è¯´æ˜ |
|------|--------|--------|------|
| å¾…æ”¯ä»˜ | PENDING | 1 | æ”¯ä»˜è®¢å•å·²åˆ›å»ºï¼Œç­‰å¾…æ”¯ä»˜ |
| æ”¯ä»˜æˆåŠŸ | SUCCESS | 2 | æ”¯ä»˜æˆåŠŸ |
| æ”¯ä»˜å¤±è´¥ | FAILED | 3 | æ”¯ä»˜å¤±è´¥ |

#### 3.2.2 çŠ¶æ€å›¾

![PaymentOrder_StateDiagram](out/UML/æ”¯ä»˜çŠ¶æ€å›¾_PaymentOrder_StateDiagram/PaymentOrder_StateDiagram.png)

> ğŸ’¡ **PlantUMLæºæ–‡ä»¶**: `ç±»å›¾UML/PaymentOrder_StateDiagram.puml`

---

<details>
<summary>ğŸ“ PlantUMLæºä»£ç ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```plantuml
@startuml PaymentOrder_StateDiagram

!theme plain

title PaymentOrderï¼ˆæ”¯ä»˜è®¢å•ï¼‰çŠ¶æ€å›¾ (UML 2.5)

[*] --> PENDING : åˆ›å»ºæ”¯ä»˜è®¢å•\n/ç”Ÿæˆæ”¯ä»˜æµæ°´å·\n/è®°å½•è®¢å•é‡‘é¢\n/é€‰æ‹©æ”¯ä»˜æ–¹å¼\n/è®¾ç½®è¿‡æœŸæ—¶é—´(15åˆ†é’Ÿ)

state "å¾…æ”¯ä»˜\nPENDING" as PENDING {
    state "ç­‰å¾…æ”¯ä»˜ç»“æœ" as Waiting
    state "è°ƒç”¨æ”¯ä»˜ç½‘å…³" as Calling
    state "ç­‰å¾…å›è°ƒ" as WaitingCallback
    
    [*] --> Calling
    Calling --> WaitingCallback : æ”¯ä»˜è¯·æ±‚å·²å‘é€
    WaitingCallback --> Waiting : ç­‰å¾…å›è°ƒ
}

PENDING --> SUCCESS : æ”¯ä»˜æˆåŠŸå›è°ƒ\n/è®°å½•æ”¯ä»˜æ—¶é—´\n/è®°å½•äº¤æ˜“è¯¦æƒ…\n/è§¦å‘åç»­æ“ä½œ

PENDING --> FAILED : æ”¯ä»˜å¤±è´¥å›è°ƒ\n/è®°å½•å¤±è´¥åŸå› \n/è®°å½•äº¤æ˜“è¯¦æƒ…

PENDING --> FAILED : æ”¯ä»˜è¶…æ—¶(15åˆ†é’Ÿ)\n/è®°å½•è¶…æ—¶åŸå› 

state "æ”¯ä»˜æˆåŠŸ\nSUCCESS" as SUCCESS {
    state "å·²å®Œæˆæ”¯ä»˜" as PaymentDone
    
    [*] --> PaymentDone
    
    PaymentDone : entry / æ›´æ–°è®¢å•çŠ¶æ€
    PaymentDone : entry / æ‰£å‡åº“å­˜
    PaymentDone : entry / æ¸…ç©ºè´­ç‰©è½¦
    PaymentDone : entry / ç”Ÿæˆæ”¯ä»˜è®°å½•
    PaymentDone : do / è§¦å‘å‘è´§é€šçŸ¥
}

state "æ”¯ä»˜å¤±è´¥\nFAILED" as FAILED {
    state "æ”¯ä»˜å·²å¤±è´¥" as PaymentFailed
    
    [*] --> PaymentFailed
    
    PaymentFailed : entry / å–æ¶ˆè®¢å•
    PaymentFailed : entry / é‡Šæ”¾åº“å­˜
    PaymentFailed : entry / ç”Ÿæˆå¤±è´¥è®°å½•
    PaymentFailed : do / é€šçŸ¥ç”¨æˆ·
}

SUCCESS --> [*] : å½’æ¡£(30å¤©å)
FAILED --> [*] : å½’æ¡£(30å¤©å)

note right of PENDING
  **è¿›å…¥æ¡ä»¶**:
  - è®¢å•çŠ¶æ€ä¸ºå¾…æ”¯ä»˜
  - è®¢å•æœªè¶…æ—¶
  
  **å†…éƒ¨è½¬æ¢**:
  - è°ƒç”¨æ”¯ä»˜ç½‘å…³
  - ç­‰å¾…æ”¯ä»˜å›è°ƒ
  - æ£€æŸ¥æ”¯ä»˜è¶…æ—¶
  
  **é€€å‡ºæ¡ä»¶**:
  - æ”¯ä»˜æˆåŠŸå›è°ƒ
  - æ”¯ä»˜å¤±è´¥å›è°ƒ
  - æ”¯ä»˜è¶…æ—¶(15åˆ†é’Ÿ)
end note

note right of SUCCESS
  **ç»ˆæ­¢çŠ¶æ€**
  ä¸å¯é€†è½¬
  
  **å†…éƒ¨åŠ¨ä½œ**:
  - entry: è¿›å…¥çŠ¶æ€æ—¶æ‰§è¡Œ
  - do: çŠ¶æ€æŒç»­æœŸé—´æ‰§è¡Œ
  
  **è§¦å‘çš„æ“ä½œ**:
  1. æ›´æ–°è®¢å•çŠ¶æ€
  2. æ‰£å‡åº“å­˜
  3. æ¸…ç©ºè´­ç‰©è½¦
  4. ç”Ÿæˆæ”¯ä»˜è®°å½•
  5. è§¦å‘å‘è´§é€šçŸ¥
end note

note bottom of FAILED
  **ç»ˆæ­¢çŠ¶æ€**
  ä¸å¯é€†è½¬
  
  **å¤±è´¥åŸå› **:
  - ä½™é¢ä¸è¶³
  - ç½‘ç»œè¶…æ—¶
  - æ”¯ä»˜å–æ¶ˆ
  - é£æ§æ‹¦æˆª
  
  **è¡¥å¿æ“ä½œ**:
  - å–æ¶ˆè®¢å•
  - é‡Šæ”¾åº“å­˜
  - é€šçŸ¥ç”¨æˆ·
end note

@enduml
```

</details>

#### 3.2.3 çŠ¶æ€è½¬æ¢è¡¨

| å½“å‰çŠ¶æ€ | äº‹ä»¶ | å®ˆå«æ¡ä»¶ | åŠ¨ä½œ | ç›®æ ‡çŠ¶æ€ |
|---------|------|---------|------|---------|
| [åˆå§‹] | åˆ›å»ºæ”¯ä»˜è®¢å• | [è®¢å•æœªè¶…æ—¶] | ç”Ÿæˆæµæ°´å·ã€è®°å½•é‡‘é¢ã€è®¾ç½®è¿‡æœŸ | å¾…æ”¯ä»˜ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜æˆåŠŸå›è°ƒ | - | è®°å½•æ”¯ä»˜æ—¶é—´ã€è®°å½•äº¤æ˜“è¯¦æƒ… | æ”¯ä»˜æˆåŠŸ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜å¤±è´¥å›è°ƒ | - | è®°å½•å¤±è´¥åŸå› ã€è®°å½•äº¤æ˜“è¯¦æƒ… | æ”¯ä»˜å¤±è´¥ |
| å¾…æ”¯ä»˜ | æ”¯ä»˜è¶…æ—¶ | [è¶…è¿‡15åˆ†é’Ÿ] | è®°å½•è¶…æ—¶åŸå›  | æ”¯ä»˜å¤±è´¥ |
| æ”¯ä»˜æˆåŠŸ | å½’æ¡£ | [30å¤©å] | å½’æ¡£æ•°æ® | [ç»ˆæ­¢] |
| æ”¯ä»˜å¤±è´¥ | å½’æ¡£ | [30å¤©å] | å½’æ¡£æ•°æ® | [ç»ˆæ­¢] |

#### 3.2.4 çŠ¶æ€å†…éƒ¨åŠ¨ä½œè¯´æ˜

**æ”¯ä»˜æˆåŠŸï¼ˆSUCCESSï¼‰çŠ¶æ€å†…éƒ¨åŠ¨ä½œ**ï¼š
- `entry /` **è¿›å…¥åŠ¨ä½œ**ï¼šçŠ¶æ€è¿›å…¥æ—¶æ‰§è¡Œä¸€æ¬¡
  - æ›´æ–°è®¢å•çŠ¶æ€ä¸º"å¾…å‘è´§"
  - æ‰£å‡å•†å“åº“å­˜
  - æ¸…ç©ºè´­ç‰©è½¦
  - ç”Ÿæˆæ”¯ä»˜è®°å½•
- `do /` **æŒç»­åŠ¨ä½œ**ï¼šçŠ¶æ€æŒç»­æœŸé—´æ‰§è¡Œ
  - è§¦å‘å‘è´§é€šçŸ¥

**æ”¯ä»˜å¤±è´¥ï¼ˆFAILEDï¼‰çŠ¶æ€å†…éƒ¨åŠ¨ä½œ**ï¼š
- `entry /` **è¿›å…¥åŠ¨ä½œ**ï¼š
  - å–æ¶ˆè®¢å•
  - é‡Šæ”¾é¢„æ‰£åº“å­˜
  - ç”Ÿæˆå¤±è´¥è®°å½•
- `do /` **æŒç»­åŠ¨ä½œ**ï¼š
  - é€šçŸ¥ç”¨æˆ·å¤±è´¥åŸå› 

---

## å››ã€åŠ¨æ€å»ºæ¨¡å…³ç³»åˆ†æ

### 4.1 é¡ºåºå›¾ä¸çŠ¶æ€å›¾çš„å…³ç³»

| è§†è§’ | é¡ºåºå›¾ | çŠ¶æ€å›¾ |
|------|--------|--------|
| **å…³æ³¨ç‚¹** | å¯¹è±¡é—´çš„äº¤äº’åºåˆ— | å•ä¸ªå¯¹è±¡çš„çŠ¶æ€å˜åŒ– |
| **æ—¶é—´ç»´åº¦** | æ¨ªå‘æ—¶é—´è½´ï¼Œå±•ç¤ºæ¶ˆæ¯ä¼ é€’é¡ºåº | çºµå‘æ—¶é—´è½´ï¼Œå±•ç¤ºçŠ¶æ€è½¬æ¢è¿‡ç¨‹ |
| **é€‚ç”¨åœºæ™¯** | ç†è§£ç”¨ä¾‹çš„æ‰§è¡Œæµç¨‹ | ç†è§£å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ |
| **UML 2.5å…ƒç´ ** | ç”Ÿå‘½çº¿ã€æ¶ˆæ¯ã€æ¿€æ´»æ¡† | çŠ¶æ€ã€è½¬æ¢ã€äº‹ä»¶ã€åŠ¨ä½œ |

### 4.2 ä¸¤ç§å›¾çš„äº’è¡¥æ€§

**é¡ºåºå›¾**å›ç­”ï¼š
- â“ å¯¹è±¡ä¹‹é—´å¦‚ä½•åä½œå®Œæˆç”¨ä¾‹ï¼Ÿ
- â“ æ¶ˆæ¯çš„ä¼ é€’é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ
- â“ å“ªäº›å¯¹è±¡å‚ä¸äº†äº¤äº’ï¼Ÿ

**çŠ¶æ€å›¾**å›ç­”ï¼š
- â“ å¯¹è±¡åœ¨ç”Ÿå‘½å‘¨æœŸä¸­æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ
- â“ çŠ¶æ€å¦‚ä½•è½¬æ¢ï¼Ÿ
- â“ ä»€ä¹ˆäº‹ä»¶è§¦å‘çŠ¶æ€è½¬æ¢ï¼Ÿ
- â“ çŠ¶æ€è½¬æ¢æ—¶æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œï¼Ÿ

### 4.3 é¡ºåºå›¾ä¸çŠ¶æ€å›¾çš„æ˜ å°„

| é¡ºåºå›¾ä¸­çš„äº¤äº’ | çŠ¶æ€å›¾ä¸­çš„ä½“ç° |
|--------------|--------------|
| UC9: ç”¨æˆ·æäº¤è®¢å• â†’ åˆ›å»ºè®¢å• | OrderçŠ¶æ€: [åˆå§‹] â†’ å¾…æ”¯ä»˜ |
| UC9: é¢„æ‰£åº“å­˜æˆåŠŸ | OrderçŠ¶æ€: è¿›å…¥"å¾…æ”¯ä»˜"ï¼ŒåŠ¨ä½œï¼šé¢„æ‰£åº“å­˜ |
| UC10: æ”¯ä»˜æˆåŠŸå›è°ƒ | PaymentOrderçŠ¶æ€: å¾…æ”¯ä»˜ â†’ æ”¯ä»˜æˆåŠŸ |
| UC10: æ”¯ä»˜æˆåŠŸå›è°ƒ | OrderçŠ¶æ€: å¾…æ”¯ä»˜ â†’ å¾…å‘è´§ |
| UC10: æ‰£å‡åº“å­˜ | OrderçŠ¶æ€: è¿›å…¥"å¾…å‘è´§"ï¼ŒåŠ¨ä½œï¼šæ‰£å‡åº“å­˜ |
| UC10: æ”¯ä»˜å¤±è´¥å›è°ƒ | PaymentOrderçŠ¶æ€: å¾…æ”¯ä»˜ â†’ æ”¯ä»˜å¤±è´¥ |
| UC10: å–æ¶ˆè®¢å•ã€é‡Šæ”¾åº“å­˜ | OrderçŠ¶æ€: å¾…æ”¯ä»˜ â†’ å·²å–æ¶ˆ |

---

## äº”ã€UML 2.5 ç¬¦å·è¯´æ˜

### 5.1 é¡ºåºå›¾ç¬¦å·

| ç¬¦å· | åç§° | PlantUMLè¯­æ³• | è¯´æ˜ |
|------|------|--------------|------|
| `â†’` | åŒæ­¥æ¶ˆæ¯ | `A -> B: message` | è°ƒç”¨æ–¹æ³•å¹¶ç­‰å¾…è¿”å› |
| `-->` | è¿”å›æ¶ˆæ¯ | `B --> A: result` | æ–¹æ³•è¿”å›å€¼ |
| `â†’)` | å¼‚æ­¥æ¶ˆæ¯ | `A ->o B: message` | ä¸ç­‰å¾…è¿”å› |
| `â”œâ”€` | æ¿€æ´»æ¡† | `activate / deactivate` | å¯¹è±¡è¢«æ¿€æ´»çš„æ—¶é—´ |
| `alt` | é€‰æ‹©ç‰‡æ®µ | `alt [condition]` | æ¡ä»¶åˆ†æ”¯ |
| `loop` | å¾ªç¯ç‰‡æ®µ | `loop [condition]` | å¾ªç¯æ‰§è¡Œ |
| `opt` | å¯é€‰ç‰‡æ®µ | `opt [condition]` | å¯é€‰æ‰§è¡Œ |

### 5.2 çŠ¶æ€å›¾ç¬¦å·

| ç¬¦å· | åç§° | PlantUMLè¯­æ³• | è¯´æ˜ |
|------|------|--------------|------|
| `â—` | åˆå§‹çŠ¶æ€ | `[*]` | çŠ¶æ€æœºçš„èµ·ç‚¹ |
| `â—‰` | ç»ˆæ­¢çŠ¶æ€ | `[*]` | çŠ¶æ€æœºçš„ç»ˆç‚¹ |
| `â–­` | çŠ¶æ€ | `state "åç§°" as XXX` | å¯¹è±¡çš„çŠ¶æ€ |
| `â†’` | è½¬æ¢ | `S1 --> S2 : event` | çŠ¶æ€è½¬æ¢ |
| `entry /` | è¿›å…¥åŠ¨ä½œ | `state : entry / action` | è¿›å…¥çŠ¶æ€æ—¶æ‰§è¡Œ |
| `do /` | æŒç»­åŠ¨ä½œ | `state : do / action` | çŠ¶æ€æŒç»­æœŸé—´æ‰§è¡Œ |
| `exit /` | é€€å‡ºåŠ¨ä½œ | `state : exit / action` | é€€å‡ºçŠ¶æ€æ—¶æ‰§è¡Œ |
